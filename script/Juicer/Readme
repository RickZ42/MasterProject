'''
apr 22, 2024, 3:01 pm gmt+10
modified the generate_site_positions.py (/g/data/xf3/zz3507/script/juicer/generate_site_positions.py)

    'hinfl'       : 'gantc'    'msel'        : 'ttaa'    'ddel'        : 'ctnag'
add the enzyme we used in the orchid 

use rita's script LigationSites.py to generate Ligation site (because Juicer doesn't recognise Ns. )
'''
import itertools
re = ['GATCGATC','GATCANTC','GATCTAA','GATCTNAG','GANTGATC','GANTANTC','GANTTAA','GANTTNAG','TTAGATC','TTAANTC','TTATAA','TTATNAG','CTNAGATC','CTNAANTC','CTNATAA','CTNATNAG']
result = []
for sequence in re:
    if 'N' in sequence:
        n_indices = [i for i, char in enumerate(sequence) if char == 'N']
        n_count = len(n_indices)
        combinations = list(itertools.product('ATCG', repeat=n_count))
        for comb in combinations:
            new_sequence = sequence
            for i, char in zip(n_indices, comb):
                new_sequence = new_sequence[:i] + char + new_sequence[i+1:]
            result.append(new_sequence)
    else:
        result.append(sequence)
print(result)
print(len(result))

'''
output
['GATCGATC', 'GATCAATC', 'GATCATTC', 'GATCACTC', 'GATCAGTC', 'GATCTAA', 'GATCTAAG', 'GATCTTAG', 'GATCTCAG', 'GATCTGAG', 'GAATGATC', 'GATTGATC', 'GACTGATC', 'GAGTGATC', 'GAATAATC', 'GAATATTC', 'GAATACTC', 'GAATAGTC', 'GATTAATC', 'GATTATTC', 'GATTACTC', 'GATTAGTC', 'GACTAATC', 'GACTATTC', 'GACTACTC', 'GACTAGTC', 'GAGTAATC', 'GAGTATTC', 'GAGTACTC', 'GAGTAGTC', 'GAATTAA', 'GATTTAA', 'GACTTAA', 'GAGTTAA', 'GAATTAAG', 'GAATTTAG', 'GAATTCAG', 'GAATTGAG', 'GATTTAAG', 'GATTTTAG', 'GATTTCAG', 'GATTTGAG', 'GACTTAAG', 'GACTTTAG', 'GACTTCAG', 'GACTTGAG', 'GAGTTAAG', 'GAGTTTAG', 'GAGTTCAG', 'GAGTTGAG', 'TTAGATC', 'TTAAATC', 'TTAATTC', 'TTAACTC', 'TTAAGTC', 'TTATAA', 'TTATAAG', 'TTATTAG', 'TTATCAG', 'TTATGAG', 'CTAAGATC', 'CTTAGATC', 'CTCAGATC', 'CTGAGATC', 'CTAAAATC', 'CTAAATTC', 'CTAAACTC', 'CTAAAGTC', 'CTTAAATC', 'CTTAATTC', 'CTTAACTC', 'CTTAAGTC', 'CTCAAATC', 'CTCAATTC', 'CTCAACTC', 'CTCAAGTC', 'CTGAAATC', 'CTGAATTC', 'CTGAACTC', 'CTGAAGTC', 'CTAATAA', 'CTTATAA', 'CTCATAA', 'CTGATAA', 'CTAATAAG', 'CTAATTAG', 'CTAATCAG', 'CTAATGAG', 'CTTATAAG', 'CTTATTAG', 'CTTATCAG', 'CTTATGAG', 'CTCATAAG', 'CTCATTAG', 'CTCATCAG', 'CTCATGAG', 'CTGATAAG', 'CTGATTAG', 'CTGATCAG', 'CTGATGAG']
100
'''

sequences_string = "GATCGATC|GATCAATC|GATCATTC|GATCACTC|GATCAGTC|GATCTAA|GATCTAAG|GATCTTAG|GATCTCAG|GATCTGAG|GAATGATC|GATTGATC|GACTGATC|GAGTGATC|GAATAATC|GAATATTC|GAATACTC|GAATAGTC|GATTAATC|GATTATTC|GATTACTC|GATTAGTC|GACTAATC|GACTATTC|GACTACTC|GACTAGTC|GAGTAATC|GAGTATTC|GAGTACTC|GAGTAGTC|GAATTAA|GATTTAA|GACTTAA|GAGTTAA|GAATTAAG|GAATTTAG|GAATTCAG|GAATTGAG|GATTTAAG|GATTTTAG|GATTTCAG|GATTTGAG|GACTTAAG|GACTTTAG|GACTTCAG|GACTTGAG|GAGTTAAG|GAGTTTAG|GAGTTCAG|GAGTTGAG|TTAGATC|TTAAATC|TTAATTC|TTAACTC|TTAAGTC|TTATAA|TTATAAG|TTATTAG|TTATCAG|TTATGAG|CTAAGATC|CTTAGATC|CTCAGATC|CTGAGATC|CTAAAATC|CTAAATTC|CTAAACTC|CTAAAGTC|CTTAAATC|CTTAATTC|CTTAACTC|CTTAAGTC|CTCAAATC|CTCAATTC|CTCAACTC|CTCAAGTC|CTGAAATC|CTGAATTC|CTGAACTC|CTGAAGTC|CTAATAA|CTTATAA|CTCATAA|CTGATAA|CTAATAAG|CTAATTAG|CTAATCAG|CTAATGAG|CTTATAAG|CTTATTAG|CTTATCAG|CTTATGAG|CTCATAAG|CTCATTAG|CTCATCAG|CTCATGAG|CTGATAAG|CTGATTAG|CTGATCAG|CTGATGAG"

sequences = sequences_string.split('|')
num_sequences = len(sequences)
print(f"There are {num_sequences} sequences in the final output.")

'''
have add the "GATCGATC|GATCAATC|GATCATTC|GATCACTC|GATCAGTC|GATCTAA|GATCTAAG|GATCTTAG|GATCTCAG|GATCTGAG|GAATGATC|GATTGATC|GACTGATC|GAGTGATC|GAATAATC|GAATATTC|GAATACTC|GAATAGTC|GATTAATC|GATTATTC|GATTACTC|GATTAGTC|GACTAATC|GACTATTC|GACTACTC|GACTAGTC|GAGTAATC|GAGTATTC|GAGTACTC|GAGTAGTC|GAATTAA|GATTTAA|GACTTAA|GAGTTAA|GAATTAAG|GAATTTAG|GAATTCAG|GAATTGAG|GATTTAAG|GATTTTAG|GATTTCAG|GATTTGAG|GACTTAAG|GACTTTAG|GACTTCAG|GACTTGAG|GAGTTAAG|GAGTTTAG|GAGTTCAG|GAGTTGAG|TTAGATC|TTAAATC|TTAATTC|TTAACTC|TTAAGTC|TTATAA|TTATAAG|TTATTAG|TTATCAG|TTATGAG|CTAAGATC|CTTAGATC|CTCAGATC|CTGAGATC|CTAAAATC|CTAAATTC|CTAAACTC|CTAAAGTC|CTTAAATC|CTTAATTC|CTTAACTC|CTTAAGTC|CTCAAATC|CTCAATTC|CTCAACTC|CTCAAGTC|CTGAAATC|CTGAATTC|CTGAACTC|CTGAAGTC|CTAATAA|CTTATAA|CTCATAA|CTGATAA|CTAATAAG|CTAATTAG|CTAATCAG|CTAATGAG|CTTATAAG|CTTATTAG|CTTATCAG|CTTATGAG|CTCATAAG|CTCATTAG|CTCATCAG|CTCATGAG|CTGATAAG|CTGATTAG|CTGATCAG|CTGATGAG"
to the juicer.sh on rsb-061244
'''