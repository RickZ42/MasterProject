+ mkdir -p /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC/assemblyQ720KOntHifiHiCBiggerThan50KContig/hap2/yahs500KHaveCorrectionQ20RemovedPCR
+ cd /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC/assemblyQ720KOntHifiHiCBiggerThan50KContig/hap2/yahs500KHaveCorrectionQ20RemovedPCR
+ /g/data/xf3/zz3507/envs/yahs/yahs/yahs -l 500000 -q20 /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC500K/assemblyQ720KOntHifiHiC500K.hic.hap2.fasta /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC500K/Removed_duplicates_Q720KOntHifiHiC500Kcontig.hic.hap2.bam
[I::main] dump hic links (BAM) to binary file yahs.out.bin
[I::dump_links_from_bam_file] 1 million records processed, 433741 read pairs 
[I::dump_links_from_bam_file] 2 million records processed, 871989 read pairs 
[I::dump_links_from_bam_file] 3 million records processed, 1314034 read pairs 
[I::dump_links_from_bam_file] 4 million records processed, 1758750 read pairs 
[I::dump_links_from_bam_file] 5 million records processed, 2204875 read pairs 
[I::dump_links_from_bam_file] 6 million records processed, 2652315 read pairs 
[I::dump_links_from_bam_file] 7 million records processed, 3100484 read pairs 
[I::dump_links_from_bam_file] 8 million records processed, 3549026 read pairs 
[I::dump_links_from_bam_file] 9 million records processed, 3986681 read pairs 
[I::dump_links_from_bam_file] 10 million records processed, 4421288 read pairs 
[I::dump_links_from_bam_file] 11 million records processed, 4860552 read pairs 
[I::dump_links_from_bam_file] 12 million records processed, 5302544 read pairs 
[I::dump_links_from_bam_file] 13 million records processed, 5747089 read pairs 
[I::dump_links_from_bam_file] 14 million records processed, 6192645 read pairs 
[I::dump_links_from_bam_file] 15 million records processed, 6639703 read pairs 
[I::dump_links_from_bam_file] 16 million records processed, 7086840 read pairs 
[I::dump_links_from_bam_file] 17 million records processed, 7531497 read pairs 
[I::dump_links_from_bam_file] 18 million records processed, 7963949 read pairs 
[I::dump_links_from_bam_file] 19 million records processed, 8401250 read pairs 
[I::dump_links_from_bam_file] 20 million records processed, 8841915 read pairs 
[I::dump_links_from_bam_file] 21 million records processed, 9285198 read pairs 
[I::dump_links_from_bam_file] 22 million records processed, 9729162 read pairs 
[I::dump_links_from_bam_file] 23 million records processed, 10174597 read pairs 
[I::dump_links_from_bam_file] 24 million records processed, 10621250 read pairs 
[I::dump_links_from_bam_file] 25 million records processed, 11067836 read pairs 
[I::dump_links_from_bam_file] 26 million records processed, 11502400 read pairs 
[I::dump_links_from_bam_file] 27 million records processed, 11937200 read pairs 
[I::dump_links_from_bam_file] 28 million records processed, 12376605 read pairs 
[I::dump_links_from_bam_file] 29 million records processed, 12818431 read pairs 
[I::dump_links_from_bam_file] 30 million records processed, 13261836 read pairs 
[I::dump_links_from_bam_file] 31 million records processed, 13706422 read pairs 
[I::dump_links_from_bam_file] 32 million records processed, 14152022 read pairs 
[I::dump_links_from_bam_file] 33 million records processed, 14598424 read pairs 
[I::dump_links_from_bam_file] 34 million records processed, 15039875 read pairs 
[I::dump_links_from_bam_file] 35 million records processed, 15473902 read pairs 
[I::dump_links_from_bam_file] 36 million records processed, 15911969 read pairs 
[I::dump_links_from_bam_file] 37 million records processed, 16353036 read pairs 
[I::dump_links_from_bam_file] 38 million records processed, 16796232 read pairs 
[I::dump_links_from_bam_file] 39 million records processed, 17240049 read pairs 
[I::dump_links_from_bam_file] 40 million records processed, 17685851 read pairs 
[I::dump_links_from_bam_file] 41 million records processed, 18131837 read pairs 
[I::dump_links_from_bam_file] 42 million records processed, 18577713 read pairs 
[I::dump_links_from_bam_file] 43 million records processed, 19011690 read pairs 
[I::dump_links_from_bam_file] 44 million records processed, 19450506 read pairs 
[I::dump_links_from_bam_file] 45 million records processed, 19892180 read pairs 
[I::dump_links_from_bam_file] 46 million records processed, 20335201 read pairs 
[I::dump_links_from_bam_file] 47 million records processed, 20779866 read pairs 
[I::dump_links_from_bam_file] 48 million records processed, 21225566 read pairs 
[I::dump_links_from_bam_file] 49 million records processed, 21672066 read pairs 
[I::dump_links_from_bam_file] 50 million records processed, 22118633 read pairs 
[I::dump_links_from_bam_file] 51 million records processed, 22556990 read pairs 
[I::dump_links_from_bam_file] 52 million records processed, 22993978 read pairs 
[I::dump_links_from_bam_file] 53 million records processed, 23435063 read pairs 
[I::dump_links_from_bam_file] 54 million records processed, 23878544 read pairs 
[I::dump_links_from_bam_file] 55 million records processed, 24324158 read pairs 
[I::dump_links_from_bam_file] 56 million records processed, 24770215 read pairs 
[I::dump_links_from_bam_file] 57 million records processed, 25217060 read pairs 
[I::dump_links_from_bam_file] 58 million records processed, 25664842 read pairs 
[I::dump_links_from_bam_file] 59 million records processed, 26108217 read pairs 
[I::dump_links_from_bam_file] 60 million records processed, 26541767 read pairs 
[I::dump_links_from_bam_file] 61 million records processed, 26979871 read pairs 
[I::dump_links_from_bam_file] 62 million records processed, 27421402 read pairs 
[I::dump_links_from_bam_file] 63 million records processed, 27865228 read pairs 
[I::dump_links_from_bam_file] 64 million records processed, 28310006 read pairs 
[I::dump_links_from_bam_file] 65 million records processed, 28755357 read pairs 
[I::dump_links_from_bam_file] 66 million records processed, 29201755 read pairs 
[I::dump_links_from_bam_file] 67 million records processed, 29646976 read pairs 
[I::dump_links_from_bam_file] 68 million records processed, 30078946 read pairs 
[I::dump_links_from_bam_file] 69 million records processed, 30515634 read pairs 
[I::dump_links_from_bam_file] 70 million records processed, 30956135 read pairs 
[I::dump_links_from_bam_file] 71 million records processed, 31398394 read pairs 
[I::dump_links_from_bam_file] 72 million records processed, 31842807 read pairs 
[I::dump_links_from_bam_file] 73 million records processed, 32287786 read pairs 
[I::dump_links_from_bam_file] 74 million records processed, 32733530 read pairs 
[I::dump_links_from_bam_file] 75 million records processed, 33179123 read pairs 
[I::dump_links_from_bam_file] position compression n = 134217728, m = 86619325, max_m = 134217727
[I::dump_links_from_bam_file] position memory buffer expanded max_m = 268435454
[I::dump_links_from_bam_file] 76 million records processed, 33615076 read pairs 
[I::dump_links_from_bam_file] 77 million records processed, 34049774 read pairs 
[I::dump_links_from_bam_file] 78 million records processed, 34488809 read pairs 
[I::dump_links_from_bam_file] 79 million records processed, 34929689 read pairs 
[I::dump_links_from_bam_file] 80 million records processed, 35373018 read pairs 
[I::dump_links_from_bam_file] 81 million records processed, 35817461 read pairs 
[I::dump_links_from_bam_file] 82 million records processed, 36262824 read pairs 
[I::dump_links_from_bam_file] 83 million records processed, 36708551 read pairs 
[I::dump_links_from_bam_file] 84 million records processed, 37151705 read pairs 
[I::dump_links_from_bam_file] 85 million records processed, 37585034 read pairs 
[I::dump_links_from_bam_file] 86 million records processed, 38023148 read pairs 
[I::dump_links_from_bam_file] 87 million records processed, 38464061 read pairs 
[I::dump_links_from_bam_file] 88 million records processed, 38907096 read pairs 
[I::dump_links_from_bam_file] 89 million records processed, 39351668 read pairs 
[I::dump_links_from_bam_file] 90 million records processed, 39796644 read pairs 
[I::dump_links_from_bam_file] 91 million records processed, 40242770 read pairs 
[I::dump_links_from_bam_file] 92 million records processed, 40688966 read pairs 
[I::dump_links_from_bam_file] 93 million records processed, 41125555 read pairs 
[I::dump_links_from_bam_file] 94 million records processed, 41563052 read pairs 
[I::dump_links_from_bam_file] 95 million records processed, 42003961 read pairs 
[I::dump_links_from_bam_file] 96 million records processed, 42447041 read pairs 
[I::dump_links_from_bam_file] 97 million records processed, 42891871 read pairs 
[I::dump_links_from_bam_file] 98 million records processed, 43337098 read pairs 
[I::dump_links_from_bam_file] 99 million records processed, 43782637 read pairs 
[I::dump_links_from_bam_file] 100 million records processed, 44229868 read pairs 
[I::dump_links_from_bam_file] position compression n = 130170785, m = 108221778, max_m = 268435454
[I::dump_links_from_bam_file] dumped 44442297 read pairs from 100475406 records: 18953548 intra links + 25488749 inter links 
[I::calc_avg_cov] sequence coverage stats:
[I::calc_avg_cov] sequence bases: 2058377819
[I::calc_avg_cov] read bases: 10473067889
[I::calc_avg_cov] q drop: 0.100
[I::calc_avg_cov] average read coverage: 3.483
[I::run_yahs] RAM total: 188.550GB
[I::run_yahs] RAM limit: 48.000GB
[I::contig_error_break] dist threshold for contig error break: 3010000
[I::contig_error_break] performed 18 round assembly error correction. Made 163 breaks 
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 27797000 (n = 25)
[I::print_asm_stats]  N90: 5309723 (n = 86)
[I::print_asm_stats]  N100: 23000 (n = 375)
[I::run_yahs] scaffolding round 1 resolution = 10000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.000
[I::run_yahs] scaffolding round 1 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 27797000 (n = 25)
[I::print_asm_stats]  N90: 5309723 (n = 86)
[I::run_yahs] scaffolding round 2 resolution = 20000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.000
[I::inter_link_norms] average link count: 70.495 194143.000 0.000
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 2 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 34818394 (n = 21)
[I::print_asm_stats]  N90: 5858000 (n = 70)
[I::run_yahs] scaffolding round 3 resolution = 50000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.000
[I::inter_link_norms] average link count: 46.683 251989.000 0.000
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 3 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 35092881 (n = 21)
[I::print_asm_stats]  N90: 5858000 (n = 68)
[I::run_yahs] scaffolding round 4 resolution = 100000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.000
[I::inter_link_norms] average link count: 332.522 753475.000 0.000
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 4 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 35217973 (n = 20)
[I::print_asm_stats]  N90: 6205000 (n = 64)
[I::run_yahs] scaffolding round 5 resolution = 200000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.005
[I::inter_link_norms] average link count: 10181.660 1359059.000 0.007
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 5 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 59685470 (n = 14)
[I::print_asm_stats]  N90: 6817000 (n = 45)
[I::run_yahs] scaffolding round 6 resolution = 500000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 0.183
[I::inter_link_norms] using new radius 32 (65) as noise ratio exceeds threshold 0.100
[I::inter_link_norms] average link count: 24583.691 551309.000 0.045
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 6 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 64110394 (n = 12)
[I::print_asm_stats]  N90: 8622261 (n = 37)
[I::run_yahs] scaffolding round 7 resolution = 1000000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 1.189
[I::inter_link_norms] using new radius 11 (66) as noise ratio exceeds threshold 0.100
[I::inter_link_norms] average link count: 2296.909 54555.000 0.042
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 7 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 64734000 (n = 12)
[I::print_asm_stats]  N90: 10336892 (n = 33)
[I::run_yahs] scaffolding round 8 resolution = 2000000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 5.071
[I::inter_link_norms] using new radius 5 (35) as noise ratio exceeds threshold 0.100
[I::inter_link_norms] average link count: 393.110 6925.000 0.057
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 8 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 69526308 (n = 11)
[I::print_asm_stats]  N90: 10336892 (n = 32)
[I::run_yahs] scaffolding round 9 resolution = 5000000
[I::run_scaffolding] starting norm estimation...
[I::run_scaffolding] starting link estimation...
[I::inter_link_norms] using noise level 33.366
[I::inter_link_norms] using new radius 3 (14) as noise ratio exceeds threshold 0.100
[I::inter_link_norms] average link count: 199.417 1457.000 0.137
[I::run_scaffolding] starting scaffolding graph contruction...
[I::run_yahs] scaffolding round 9 done
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 77938702 (n = 11)
[I::print_asm_stats]  N90: 6991000 (n = 32)
[I::run_yahs] scaffolding round 10 resolution = 10000000
[I::run_yahs] assembly N50 (77938702) too small. End of scaffolding.
[I::main] writing FASTA file for scaffolds
[I::write_fasta_file_from_agp] Number sequences: 284
[I::write_fasta_file_from_agp] Number bases: 2058386919
[I::print_asm_stats] assembly stats:
[I::print_asm_stats]  N50: 77938702 (n = 11)
[I::print_asm_stats]  N90: 6991000 (n = 32)
[I::print_asm_stats]  N100: 23000 (n = 284)
[I::main] Version: 1.2
[I::main] CMD: /g/data/xf3/zz3507/envs/yahs/yahs/yahs -l 500000 -q20 /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC500K/assemblyQ720KOntHifiHiC500K.hic.hap2.fasta /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC500K/Removed_duplicates_Q720KOntHifiHiC500Kcontig.hic.hap2.bam
[I::main] Real time: 381.555 sec; CPU: 381.286 sec; Peak RSS: 4.237 GB
+ samtools faidx ./yahs.out_scaffolds_final.fa
+ cut -f 1-2 ./yahs.out_scaffolds_final.fa.fai
+ /g/data/xf3/zz3507/envs/yahs/yahs/juicer pre -a -o out_JBAT ./yahs.out.bin ./yahs.out_scaffolds_final.agp /g/data/xf3/zz3507/Output/assemblyQ720KOntHifiHiC500K/assemblyQ720KOntHifiHiC500K.hic.hap2.fasta.fai
+ java -jar -Xmx48G /g/data/xf3/zz3507/envs/JuicerTools1.22.01.jar pre -j 4 out_JBAT.txt out_JBAT.hic.part /dev/fd/63
++ cat out_JBAT.log
++ grep PRE_C_SIZE
++ awk '{print $2" "$3}'
+ mv out_JBAT.hic.part out_JBAT.hic
